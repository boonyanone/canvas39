<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas 39 - Elevator Display</title>
    
    <!-- Tailwind CSS -->
    <script>
        // ‡∏õ‡∏¥‡∏î warning console - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
        (function() {
            const originalWarn = console.warn;
            console.warn = function(...args) {
                const message = args.join(' ');
                if (message.includes('tailwindcss.com should not be used in production') || 
                    message.includes('cdn.tailwindcss.com should not be used in production')) {
                    return; // ‡∏ã‡πà‡∏≠‡∏ô warning ‡∏ô‡∏µ‡πâ
                }
                originalWarn.apply(console, args);
            };
        })();
    </script>
    <script src="https://cdn.tailwindcss.com?v=3.4.0"></script>
    <script>
        if (window.tailwind) {
            window.tailwind.config = { 
                corePlugins: { preflight: false }
            };
        }
    </script>
    
    <style>
        /* Fix any styling issues */
        body {
            margin: 0 !important;
            padding: 0 !important;
        }
        
        /* Swiper custom styles */
        .quality-slideshow {
            width: 100%;
            height: 100%;
        }
        
        .quality-slideshow .swiper-slide {
            display: flex;
            align-items: stretch;
            height: 100%;
        }
        
        /* Remove default Swiper pagination */
        .quality-slideshow .swiper-pagination {
            display: none !important;
        }
        
        /* Remove default Swiper navigation */
        .quality-slideshow .swiper-button-next,
        .quality-slideshow .swiper-button-prev {
            display: none !important;
        }
        
        /* Smooth transitions with hardware acceleration */
        .quality-slideshow .swiper-wrapper {
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }
        
        /* Ensure slides take full height */
        .quality-slideshow .swiper-slide > div {
            width: 100%;
            height: 100%;
        }
        
        /* Force remove any background from SVG icons */
        svg.w-6.h-6 {
            background: none !important;
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
        }
        
        /* Ensure borders and layout stay intact */
        .border-t-2 {
            border-top-width: 2px !important;
            border-top-style: solid !important;
        }
        
        .border-gray-300 {
            border-color: #d1d5db !important;
        }
        
        /* Force display of weather section border */
        .weather-section-border {
            border-top: 2px solid #d1d5db !important;
        }
        
        /* HR line styles for AQI sections */
        hr {
            border: none !important;
            border-top: 1px solid !important;
            margin: 8px 0 !important;
        }
    </style>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    
    <!-- Swiper.js -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    
    <!-- JSONBin.io + Firebase Configuration -->
    <script>
        // JSONBin.io Configuration (Primary)
        const JSONBIN_CONFIG = {
            binId: '68d0fd7643b1c97be94b2806',
            accessKey: '$2a$10$9izErv0jJeqLJODXAxr15ugm42tS.ibw1QqZdOLFV.3XNeBNVsCda'
        };
        
        console.log('üì¶ JSONBin.io configured for display (Primary)');
        
        // Debug function ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logo
        window.debugLogo = function() {
            const logoImg = document.querySelector('img[alt="Canvas 39 Logo"]');
            if (logoImg) {
                console.log('üñºÔ∏è Logo element:', logoImg);
                console.log('üñºÔ∏è Logo src:', logoImg.src);
                console.log('üñºÔ∏è Logo filter:', logoImg.style.filter);
                console.log('üñºÔ∏è Logo computed style:', getComputedStyle(logoImg).filter);
                
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö filter
                logoImg.style.filter = 'brightness(0) invert(1)';
                console.log('üß™ Applied white filter to logo');
            } else {
                console.log('‚ùå Logo element not found');
                // ‡∏´‡∏≤ logo elements ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                console.log('üîç All img elements:', document.querySelectorAll('img'));
            }
        };
        
        // Debug function ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö admin
        window.debugAdminLogo = function() {
            const logoPreview = document.getElementById('logoPreview');
            if (logoPreview) {
                console.log('üñºÔ∏è Admin logo preview:', logoPreview);
                console.log('üñºÔ∏è Admin logo src:', logoPreview.src);
            } else {
                console.log('‚ùå Admin logo preview not found');
            }
        };
        
        // Debug function ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Swiper slideshow
        window.debugSlideshow = function() {
            console.log('üé¨ Swiper Slideshow Debug:');
            console.log('- Swiper instance:', swiper);
            console.log('- Active index:', swiper?.activeIndex);
            console.log('- Autoplay running:', swiper?.autoplay?.running);
            console.log('- Autoplay delay:', swiper?.params?.autoplay?.delay);
            console.log('- Touch enabled:', swiper?.params?.touchRatio);
            console.log('- Slideshow config:', slideshowConfig);
            
            // Emergency functions for testing
            window.forceStopSlideshow = stopSlideshow;
            window.forceStartSlideshow = startSlideshow;
            window.restartSlideshow = restartSlideshow;
        };
        
        // Simple monitoring system
        let monitoringStats = {
            startTime: Date.now(),
            configUpdates: 0,
            weatherUpdates: 0,
            aqiUpdates: 0,
            slideshowChanges: 0,
            errors: [],
            lastUpdate: null,
            uptime: 0,
            averageUpdateTime: 0,
            updateTimes: []
        };
        
        // Monitor system health
        function updateMonitoringStats(event, duration = 0) {
            monitoringStats.lastUpdate = Date.now();
            monitoringStats.uptime = monitoringStats.lastUpdate - monitoringStats.startTime;
            
            switch(event) {
                case 'config-update':
                    monitoringStats.configUpdates++;
                    break;
                case 'weather-update':
                    monitoringStats.weatherUpdates++;
                    if (duration > 0) {
                        monitoringStats.updateTimes.push(duration);
                        monitoringStats.averageUpdateTime = monitoringStats.updateTimes.reduce((a, b) => a + b, 0) / monitoringStats.updateTimes.length;
                    }
                    break;
                case 'aqi-update':
                    monitoringStats.aqiUpdates++;
                    break;
                case 'slideshow-change':
                    monitoringStats.slideshowChanges++;
                    break;
                case 'error':
                    monitoringStats.errors.push({
                        timestamp: Date.now(),
                        error: duration // In this case duration is the error message
                    });
                    // Keep only last 10 errors
                    if (monitoringStats.errors.length > 10) {
                        monitoringStats.errors = monitoringStats.errors.slice(-10);
                    }
                    break;
            }
            
            // Log stats every 10 minutes
            if (monitoringStats.uptime > 0 && monitoringStats.uptime % (10 * 60 * 1000) < 1000) {
                console.log('üìä System Health Report:', {
                    uptime: formatUptime(monitoringStats.uptime),
                    configUpdates: monitoringStats.configUpdates,
                    weatherUpdates: monitoringStats.weatherUpdates,
                    aqiUpdates: monitoringStats.aqiUpdates,
                    slideshowChanges: monitoringStats.slideshowChanges,
                    recentErrors: monitoringStats.errors.length,
                    avgUpdateTime: Math.round(monitoringStats.averageUpdateTime) + 'ms'
                });
            }
        }
        
        function formatUptime(ms) {
            const seconds = Math.floor(ms / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            
            if (hours > 0) return `${hours}h ${minutes % 60}m`;
            if (minutes > 0) return `${minutes}m ${seconds % 60}s`;
            return `${seconds}s`;
        }
        
        // Global error handler
        window.addEventListener('error', function(e) {
            updateMonitoringStats('error', `${e.message} at ${e.filename}:${e.lineno}`);
            console.error('üö® Global Error:', e.error);
        });
        
        window.addEventListener('unhandledrejection', function(e) {
            updateMonitoringStats('error', `Unhandled Promise: ${e.reason}`);
            console.error('üö® Unhandled Promise Rejection:', e.reason);
        });
        
        // Debug functions for monitoring
        window.getSystemStats = function() {
            return {
                ...monitoringStats,
                uptimeFormatted: formatUptime(monitoringStats.uptime),
                memoryUsage: performance.memory ? {
                    used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) + 'MB',
                    total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024) + 'MB',
                    limit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024) + 'MB'
                } : 'Not available'
            };
        };
        
        window.clearStats = function() {
            monitoringStats = {
                startTime: Date.now(),
                configUpdates: 0,
                weatherUpdates: 0,
                aqiUpdates: 0,
                slideshowChanges: 0,
                errors: [],
                lastUpdate: null,
                uptime: 0,
                averageUpdateTime: 0,
                updateTimes: []
            };
            console.log('üìä Monitoring stats cleared');
        };
    </script>
    
    <!-- Firebase SDK (Backup) -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, get } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyDJ2iqJUyjd5m0xe0rz-IyRiNyCD3Ga8XM",
            authDomain: "canvas39-display.firebaseapp.com",
            databaseURL: "https://canvas39-display-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "canvas39-display",
            storageBucket: "canvas39-display.firebasestorage.app",
            messagingSenderId: "126886607717",
            appId: "1:126886607717:web:01029a9d874d87dfc5bf8c"
        };
        
        try {
            const app = initializeApp(firebaseConfig);
            const database = getDatabase(app);
            
            // Make Firebase functions globally available
            window.firebaseDB = database;
            window.firebaseRef = ref;
            window.firebaseGet = get;
            
            console.log('üî• Firebase initialized for display (Backup)');
        } catch (error) {
            console.warn('‚ö†Ô∏è Firebase backup not available for display:', error);
        }
    </script>
    
    <style>
        /* Weather Icon Animations */
        .weather-icon-sun {
            animation: rotate 8s linear infinite;
        }
        
        .weather-icon-rain {
            animation: rain-drop 2s ease-in-out infinite;
        }
        
        .weather-icon-cloud {
            animation: float 4s ease-in-out infinite;
        }
        
        .weather-icon-thunder {
            animation: thunder-flash 3s ease-in-out infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes rain-drop {
            0%, 100% { transform: translateY(0px); opacity: 1; }
            50% { transform: translateY(2px); opacity: 0.8; }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-2px); }
        }
        
        @keyframes thunder-flash {
            0%, 90%, 100% { opacity: 1; }
            5%, 15% { opacity: 0.8; }
            10% { opacity: 1.2; filter: brightness(1.2); }
        }
        
        @keyframes marquee {
            0% { transform: translateX(100vw); }
            100% { transform: translateX(-100%); }
        }
        
        .animate-marquee {
            animation: marquee 15s linear infinite;
        }
    </style>
</head>
<body>
    <div class="w-full h-screen bg-stone-400 flex flex-col">
        <!-- Header Notifications -->
        <div id="headerNotifications" class="hidden">
            <!-- Header notifications will be inserted here -->
        </div>

        <!-- Header -->
        <div class="bg-amber-900 flex items-center justify-between px-8 py-4 flex-shrink-0 h-[10.53vh]" style="background-color: #3f2f15;">
            <div class="w-16 h-16 flex items-center justify-center">
                <img src="img/logo.png" alt="Canvas 39 Logo" class="w-full h-full object-contain" style="filter: brightness(0) invert(1);">
            </div>
            <div class="text-center text-white">
                <div class="text-2xl mb-2" id="currentDate">Wednesday, 27 November</div>
                <div class="text-4xl font-light" id="currentTime">16:41</div>
            </div>
            <button id="fullscreenBtn" class="w-12 h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center text-white hover:bg-opacity-30 transition-all duration-300">
                <i data-lucide="maximize" class="w-4 h-4" id="fullscreenIcon"></i>
            </button>
        </div>

        <!-- Building Image Section -->
        <div class="flex items-center justify-center text-white text-lg h-[31.58vh] flex-shrink-0 relative" style="background-color: #87ceeb; background-image: url('img/FRONT FULL.jpg'); background-size: cover; background-repeat: no-repeat; background-position: center;">
            <!-- Notification Overlay -->
            <div id="notificationOverlay" class="absolute inset-0 bg-black bg-opacity-75 flex items-center justify-center z-10 hidden">
                <div class="bg-white rounded-lg p-6 max-w-md mx-4 text-center shadow-2xl">
                    <div id="notificationContent" class="text-gray-700"></div>
                </div>
            </div>
        </div>

        <!-- Weather Section -->
        <div class="border-t-2 border-gray-300 weather-section-border flex flex-shrink-0 h-[15.79vh]" style="background-color: #e8ddd4;">
            <!-- Today -->
            <div class="w-2/5 p-8 flex flex-col justify-start" style="background-color: #f3efe6;">
                <div class="text-lg mb-3 font-medium" style="color: #3f2f15;" id="todayTextDisplay">TODAY</div>
                <div class="flex flex-col items-center justify-center flex-1">
                    <div class="w-8 h-8 sm:w-12 sm:h-12 mb-1" id="todayIcon">
                        <svg viewBox="0 0 48 48" class="w-full h-full">
                            <!-- Rain Cloud -->
                            <path d="M36 20c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 .685.057 1.354.166 2.001C9.97 22.46 8 24.81 8 27.5 8 30.537 10.463 33 13.5 33h21c3.037 0 5.5-2.463 5.5-5.5 0-2.69-1.97-5.04-4.166-5.499.109-.647.166-1.316.166-2.001z" fill="none" stroke="#3f2f15" stroke-width="2"/>
                            <!-- Rain Drops -->
                            <line x1="16" y1="36" x2="16" y2="42" stroke="#3f2f15" stroke-width="2" stroke-linecap="round"/>
                            <line x1="20" y1="38" x2="20" y2="44" stroke="#3f2f15" stroke-width="2" stroke-linecap="round"/>
                            <line x1="24" y1="36" x2="24" y2="42" stroke="#3f2f15" stroke-width="2" stroke-linecap="round"/>
                            <line x1="28" y1="38" x2="28" y2="44" stroke="#3f2f15" stroke-width="2" stroke-linecap="round"/>
                            <line x1="32" y1="36" x2="32" y2="42" stroke="#3f2f15" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="text-lg flex items-center gap-1 font-medium" style="color: #3f2f15;">
                        <span id="lowTemp">26¬∞C</span>
                        <span>/</span>
                        <span id="highTemp">34¬∞C</span>
                    </div>
                </div>
            </div>
            <!-- Outlook -->
            <div class="w-3/5 p-8 flex flex-col justify-start" style="background-color: #ddd6cc;">
                <div class="text-lg mb-3 font-medium" style="color: #3f2f15;" id="outlookTextDisplay">OUTLOOK</div>
                <div class="grid grid-cols-4 gap-3 flex-1 items-center" id="forecastGrid">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Footer Notifications (Marquee) -->
        <div id="footerNotifications" class="hidden h-8 overflow-hidden flex-shrink-0">
            <!-- Footer notifications will be inserted here -->
        </div>

        <!-- Quality Information Slideshow with Swiper -->
        <div class="relative flex-shrink-0 h-[39vh]" style="background-color: #929079;">
            <div class="swiper quality-slideshow">
                <div class="swiper-wrapper">
                    <!-- Slide 1: Air Quality -->
                    <div class="swiper-slide">
                        <div class="p-8 h-full flex flex-col">
                            <!-- Header Title -->
                            <div class="text-center mb-4">
                                <h2 class="text-xl font-medium tracking-wide" style="color: #3f2f15;">
                                    <span class="inline-block px-4 py-2 bg-white bg-opacity-20 rounded-full" id="airQualityTextDisplay">AIR QUALITY</span>
                                </h2>
                            </div>
                            
                            <!-- Content Grid -->
                            <div class="flex gap-8 mb-8">
                                <!-- Indoor Section -->
                                <div class="flex-1">
                                    <div class="text-lg mb-3 font-medium" style="color: #3f2f15;" id="indoorTextDisplay">INDOOR</div>
                                    <div class="bg-green-500 rounded-xl shadow-lg overflow-hidden">
                                        <div class="p-6">
                                            <div class="flex justify-between items-start mb-4">
                                                <div class="flex flex-col">
                                                    <div class="flex items-end gap-3 mb-2">
                                                        <div class="text-5xl font-light leading-none bg-black bg-opacity-20 px-3 py-1 rounded-lg" style="color: #3f2f15;" id="indoorAQI">40</div>
                                                        <div class="text-lg font-semibold pb-1" style="color: #3f2f15;" id="indoorLevel">Good</div>
                                                    </div>
                                                    <div class="text-sm opacity-80" style="color: #3f2f15;">US AQI Index</div>
                                                </div>
                                                <div class="w-12 h-12 flex-shrink-0" id="indoorFace">
                                                    <img src="https://www.iqair.com/dl/assets/aqi/ic-face-green.svg" alt="AQI Face" class="w-full h-full object-contain filter brightness-0">
                                                </div>
                                            </div>
                                            <div class="border-t border-white border-opacity-30 pt-3">
                                                <div class="flex justify-between items-center text-sm" style="color: #3f2f15;">
                                                    <span class="opacity-80">Main pollutant:</span>
                                                    <span class="font-semibold" id="indoorPollutant">PM10</span>
                                                </div>
                                                <div class="flex justify-between items-center text-sm mt-1" style="color: #3f2f15;">
                                                    <span class="opacity-80">Concentration:</span>
                                                    <span class="font-semibold"><span id="indoorConcentration">43.5</span> Œºg/m¬≥</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Outdoor Section -->
                                <div class="flex-1">
                                    <div class="text-lg mb-3 font-medium" style="color: #3f2f15;" id="outdoorTextDisplay">OUTDOOR</div>
                                    <div class="bg-yellow-500 rounded-xl shadow-lg overflow-hidden">
                                        <div class="p-6">
                                            <div class="flex justify-between items-start mb-4">
                                                <div class="flex flex-col">
                                                    <div class="flex items-end gap-3 mb-2">
                                                        <div class="text-5xl font-light leading-none bg-black bg-opacity-20 px-3 py-1 rounded-lg" style="color: #3f2f15;" id="outdoorAQI">84</div>
                                                        <div class="text-lg font-semibold pb-1" style="color: #3f2f15;" id="outdoorLevel">Moderate</div>
                                                    </div>
                                                    <div class="text-sm opacity-80" style="color: #3f2f15;">US AQI Index</div>
                                                </div>
                                                <div class="w-12 h-12 flex-shrink-0" id="outdoorFace">
                                                    <img src="https://www.iqair.com/dl/assets/aqi/ic-face-yellow.svg" alt="AQI Face" class="w-full h-full object-contain filter brightness-0">
                                                </div>
                                            </div>
                                            <div class="border-t border-white border-opacity-30 pt-3">
                                                <div class="flex justify-between items-center text-sm" style="color: #3f2f15;">
                                                    <span class="opacity-80">Main pollutant:</span>
                                                    <span class="font-semibold" id="outdoorPollutant">PM2.5</span>
                                                </div>
                                                <div class="flex justify-between items-center text-sm mt-1" style="color: #3f2f15;">
                                                    <span class="opacity-80">Concentration:</span>
                                                    <span class="font-semibold"><span id="outdoorConcentration">27</span> Œºg/m¬≥</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bottom Spacer -->
                            <div class="flex-1"></div>
                        </div>
                    </div>

                    <!-- Slide 2: Pool Water Quality -->
                    <div class="swiper-slide">
                        <div class="p-8 h-full flex flex-col" style="background-color: #b7a591;">
                            <!-- Header Title -->
                            <div class="text-center mb-4">
                                <h2 class="text-xl font-medium tracking-wide" style="color: #3f2f15;">
                                    <span class="inline-block px-4 py-2 bg-white bg-opacity-20 rounded-full" id="poolWaterTextDisplay">POOL WATER QUALITY</span>
                                </h2>
                            </div>
                            
                            <!-- Content Grid -->
                            <div class="grid grid-cols-4 gap-4 mb-6">
                                <!-- Temperature -->
                                <div class="flex flex-col">
                                    <div class="text-sm mb-2 font-medium text-center" style="color: #3f2f15;">
                                        <span class="inline-block px-2 py-1 bg-white bg-opacity-20 rounded-full text-xs">TEMP</span>
                                    </div>
                                    <div class="bg-blue-500 rounded-xl shadow-lg overflow-hidden h-32">
                                        <div class="p-4">
                                            <div class="flex flex-col items-center text-center">
                                                <svg class="w-6 h-6 mb-2" style="color: #3f2f15;" fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M15 13V5c0-1.66-1.34-3-3-3S9 3.34 9 5v8c-1.21.91-2 2.37-2 4 0 2.76 2.24 5 5 5s5-2.24 5-5c0-1.63-.79-3.09-2-4zm-4-2V5c0-.55.45-1 1-1s1 .45 1 1v6h-2zm1 9c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"/>
                                                </svg>
                                                <div class="text-4xl font-bold leading-none" style="color: #3f2f15;" id="poolTemperature">27.5</div>
                                                <div class="text-sm font-medium" style="color: #3f2f15;">¬∞C</div>
                                                <div class="text-xs opacity-80 mt-1" style="color: #3f2f15;">OPTIMAL</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- pH Level -->
                                <div class="flex flex-col">
                                    <div class="text-sm mb-2 font-medium text-center" style="color: #3f2f15;">
                                        <span class="inline-block px-2 py-1 bg-white bg-opacity-20 rounded-full text-xs">pH</span>
                                    </div>
                                    <div class="bg-green-500 rounded-xl shadow-lg overflow-hidden h-32">
                                        <div class="p-4">
                                            <div class="flex flex-col items-center text-center">
                                                <svg class="w-6 h-6 mb-2" style="color: #3f2f15;" fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h-2v-6h2v6zm0-8h-2V7h2v2zm1 8V7h6v2h-4v2h3v2h-3v2h4v2h-6z"/>
                                                </svg>
                                                <div class="text-4xl font-bold leading-none" style="color: #3f2f15;" id="poolPH">7.4</div>
                                                <div class="text-sm font-medium" style="color: #3f2f15;">pH</div>
                                                <div class="text-xs opacity-80 mt-1" style="color: #3f2f15;">OPTIMAL</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ORP -->
                                <div class="flex flex-col">
                                    <div class="text-sm mb-2 font-medium text-center" style="color: #3f2f15;">
                                        <span class="inline-block px-2 py-1 bg-white bg-opacity-20 rounded-full text-xs">ORP</span>
                                    </div>
                                    <div class="bg-purple-500 rounded-xl shadow-lg overflow-hidden h-32">
                                        <div class="p-4">
                                            <div class="flex flex-col items-center text-center">
                                                <svg class="w-6 h-6 mb-2" style="color: #3f2f15;" fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M12 2L8 6v4h1v10h6V10h1V6l-4-4zm0 2.83L13.17 6H10.83L12 4.83zM10 8h4v1h-4V8zm1 3h2v8h-2v-8z"/>
                                                    <circle cx="12" cy="20" r="1"/>
                                                    <path d="M8 16h2v1H8zm6 0h2v1h-2z"/>
                                                </svg>
                                                <div class="text-4xl font-bold leading-none" style="color: #3f2f15;" id="poolORP">720</div>
                                                <div class="text-sm font-medium" style="color: #3f2f15;">mV</div>
                                                <div class="text-xs opacity-80 mt-1" style="color: #3f2f15;">GOOD</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- TDS -->
                                <div class="flex flex-col">
                                    <div class="text-sm mb-2 font-medium text-center" style="color: #3f2f15;">
                                        <span class="inline-block px-2 py-1 bg-white bg-opacity-20 rounded-full text-xs">TDS</span>
                                    </div>
                                    <div class="bg-orange-500 rounded-xl shadow-lg overflow-hidden h-32">
                                        <div class="p-4">
                                            <div class="flex flex-col items-center text-center">
                                                <svg class="w-6 h-6 mb-2" style="color: #3f2f15;" fill="currentColor" viewBox="0 0 24 24">
                                                    <rect x="4" y="6" width="16" height="12" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                                                    <path d="M8 10h8M8 12h8M8 14h8"/>
                                                    <circle cx="6" cy="9" r="0.5"/>
                                                    <circle cx="18" cy="9" r="0.5"/>
                                                    <circle cx="6" cy="12" r="0.5"/>
                                                    <circle cx="18" cy="12" r="0.5"/>
                                                    <circle cx="6" cy="15" r="0.5"/>
                                                    <circle cx="18" cy="15" r="0.5"/>
                                                    <path d="M10 3V6M14 3V6M10 18V21M14 18V21"/>
                                                </svg>
                                                <div class="text-4xl font-bold leading-none" style="color: #3f2f15;" id="poolTDS">450</div>
                                                <div class="text-sm font-medium" style="color: #3f2f15;">ppm</div>
                                                <div class="text-xs opacity-80 mt-1" style="color: #3f2f15;">GOOD</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Water Index Status -->
                            <div class="mb-6">
                                <div class="bg-white bg-opacity-20 rounded-xl p-4 text-center">
                                    <div class="text-lg font-medium mb-1" style="color: #3f2f15;">Water Index</div>
                                    <div class="text-2xl font-bold text-green-600">OPTIMAL</div>
                                    <div class="text-sm opacity-80" style="color: #3f2f15;">Safe for swimming</div>
                                </div>
                            </div>
                            
                            <!-- Bottom Spacer -->
                            <div class="flex-1"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Parse configuration from Firebase, JSONBin.io, or localStorage
        async function parseConfig() {
            
            
            // Try to load from JSONBin.io (Primary)
            try {
                console.log('üì¶ Loading config from JSONBin.io (Primary)...');
                
                const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_CONFIG.binId}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Access-Key': JSONBIN_CONFIG.accessKey
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    const configData = result.record;
                    
                    console.log('‚úÖ Configuration loaded from JSONBin.io:', configData);
                    
                    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö cache
                    try {
                        localStorage.setItem('canvas39_admin_config', JSON.stringify(configData));
                        console.log('üíæ Config cached to localStorage');
                    } catch (error) {
                        console.warn('‚ùå Failed to cache config:', error);
                    }
                    
                    return configData;
                } else {
                    console.log('‚ö†Ô∏è JSONBin.io response not ok, trying Firebase backup...');
                }
            } catch (error) {
                console.error('‚ùå Failed to load from JSONBin.io:', error);
            }
            
            // Try Firebase backup
            if (window.firebaseDB && window.firebaseGet && window.firebaseRef) {
                try {
                    console.log('üî• Loading config from Firebase (Backup)...');
                    const snapshot = await window.firebaseGet(window.firebaseRef(window.firebaseDB, 'canvas39-config'));
                    
                    if (snapshot.exists()) {
                        const configData = snapshot.val();
                        console.log('‚úÖ Configuration loaded from Firebase backup:', configData);
                        
                        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö cache
                        try {
                            localStorage.setItem('canvas39_admin_config', JSON.stringify(configData));
                            console.log('üíæ Config cached to localStorage from Firebase');
                        } catch (error) {
                            console.warn('‚ùå Failed to cache config:', error);
                        }
                        
                        return configData;
                    } else {
                        console.log('‚ö†Ô∏è No config found in Firebase backup either...');
                    }
                } catch (error) {
                    console.error('‚ùå Failed to load from Firebase backup:', error);
                }
            }
            
            // Fallback to localStorage (for cache/offline usage)
            try {
                const savedConfig = localStorage.getItem('canvas39_admin_config');
                console.log('üîç Checking localStorage cache:', savedConfig ? 'Found' : 'Empty');
                if (savedConfig) {
                    console.log('üìÑ Loading config from localStorage cache');
                    const parsed = JSON.parse(savedConfig);
                    console.log('üìä Config data:', parsed);
                    return parsed;
                }
            } catch (error) {
                console.error('‚ùå Error parsing config from localStorage:', error);
            }
            
            console.log('‚ö†Ô∏è No configuration found - creating default config');
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á default config ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ
            const defaultConfig = {
                font: 'default',
                weatherApi: 'openmeteo',
                updateInterval: 10,
                notices: [],
                images: {
                    logo: 'img/logo.png',
                    building: 'img/FRONT FULL.jpg'
                }
            };
            
            try {
                localStorage.setItem('canvas39_admin_config', JSON.stringify(defaultConfig));
                console.log('‚úÖ Default config created and saved');
            } catch (error) {
                console.error('‚ùå Failed to save default config:', error);
            }
            
            return defaultConfig;
        }

        // Listen for config updates from other windows (BroadcastChannel)
        function listenForConfigUpdates() {
            try {
                const channel = new BroadcastChannel('canvas39-config');
                console.log('üìª BroadcastChannel listener started');
                
                channel.addEventListener('message', async (event) => {
                    console.log('üì° Received broadcast message:', event.data);
                    if (event.data.type === 'config-update') {
                        console.log('üîÑ Processing config update from admin panel');
                        
                        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï localStorage cache
                        try {
                            localStorage.setItem('canvas39_admin_config', JSON.stringify(event.data.config));
                            console.log('üíæ Config cached to localStorage');
                        } catch (error) {
                            console.error('‚ùå Failed to save config to localStorage:', error);
                        }
                        
                        // Apply config to display immediately
                        applyConfig(event.data.config);
                    }
                });
                
                channel.addEventListener('error', (error) => {
                    console.error('‚ùå BroadcastChannel error:', error);
                });
                
            } catch (error) {
                console.warn('‚ùå BroadcastChannel not supported:', error);
            }
        }

        // Apply configuration to display
        function applyConfig(config) {
            if (!config) {
                console.log('‚ö†Ô∏è No config found, using default');
                return;
            }

            console.log('üîß Applying configuration:', config);

            // Apply font
            if (config.font && config.font !== 'default') {
                const fontMap = {
                    'roman': { family: 'Roman', source: 'local' },
                    'kanit': { family: 'Kanit', source: 'google' },
                    'sarabun': { family: 'Sarabun', source: 'google' },
                    'inter': { family: 'Inter', source: 'google' },
                    'roboto': { family: 'Roboto', source: 'google' },
                    'noto-thai': { family: 'Noto Sans Thai', source: 'google' },
                    'prompt': { family: 'Prompt', source: 'google' },
                    'mitr': { family: 'Mitr', source: 'google' },
                    'custom': { family: 'CustomFont', source: 'custom' }
                };

                const selectedFont = fontMap[config.font];
                if (selectedFont) {
                    if (selectedFont.source === 'google') {
                        // Load Google Font
                        const link = document.createElement('link');
                        link.rel = 'stylesheet';
                        link.href = `https://fonts.googleapis.com/css2?family=${selectedFont.family.replace(' ', '+')}:wght@300;400;500;600;700&display=swap`;
                        document.head.appendChild(link);
                    } else if (selectedFont.source === 'custom') {
                        // Load custom font from config
                        if (config.customFont && config.customFont.data) {
                            const style = document.createElement('style');
                            style.textContent = `
                                @font-face {
                                    font-family: 'CustomFont';
                                    src: url('${config.customFont.data}') format('${config.customFont.format || 'woff2'}');
                                    font-weight: normal;
                                    font-style: normal;
                                }
                            `;
                            document.head.appendChild(style);
                            console.log('üî§ Custom font loaded:', config.customFont.name);
                        }
                    }
                    
                    // Apply font to body
                    document.body.style.fontFamily = `'${selectedFont.family}', sans-serif`;
                    console.log('üî§ Font applied:', selectedFont.family);
                }
            }

            // Apply layout configuration
            if (config.layout) {
                // Header configuration
                if (config.layout.header) {
                    const headerEl = document.querySelector('.bg-amber-900');
                    if (headerEl && config.layout.header.backgroundColor) {
                        headerEl.style.backgroundColor = config.layout.header.backgroundColor;
                    }
                    
                    const dateTimeEl = document.querySelector('.text-center.text-white');
                    if (dateTimeEl && config.layout.header.textColor) {
                        dateTimeEl.style.color = config.layout.header.textColor;
                    }
                    
                    if (config.layout.header.height) {
                        const headerEl = document.querySelector('.h-\\[10\\.53vh\\]');
                        if (headerEl) {
                            headerEl.style.height = config.layout.header.height + 'vh';
                        }
                    }
                }
                
                // Weather section configuration  
                if (config.layout.weather) {
                    if (config.layout.weather.backgroundColor) {
                        const weatherSections = document.querySelectorAll('[style*="background-color: #e8ddd4"], [style*="background-color: #f3efe6"], [style*="background-color: #ddd6cc"]');
                        weatherSections.forEach(section => {
                            section.style.backgroundColor = config.layout.weather.backgroundColor;
                        });
                    }
                    
                    if (config.layout.weather.textColor) {
                        const weatherTexts = document.querySelectorAll('[style*="color: #3f2f15"]');
                        weatherTexts.forEach(text => {
                            text.style.color = config.layout.weather.textColor;
                        });
                    }
                    
                    if (config.layout.weather.height) {
                        const weatherEl = document.querySelector('.h-\\[15\\.79vh\\]');
                        if (weatherEl) {
                            weatherEl.style.height = config.layout.weather.height + 'vh';
                        }
                    }
                }
                
                // Quality section configuration
                if (config.layout.quality) {
                    if (config.layout.quality.backgroundColor) {
                        const qualitySections = document.querySelectorAll('[style*="background-color: #929079"], [style*="background-color: #b7a591"]');
                        qualitySections.forEach(section => {
                            section.style.backgroundColor = config.layout.quality.backgroundColor;
                        });
                    }
                    
                    if (config.layout.quality.height) {
                        const qualityEl = document.querySelector('.h-\\[42\\.1vh\\]');
                        if (qualityEl) {
                            qualityEl.style.height = config.layout.quality.height + 'vh';
                        }
                    }
                }
                
                // Building section configuration
                if (config.layout.building) {
                    const buildingEl = document.querySelector('.h-\\[31\\.58vh\\]');
                    if (buildingEl) {
                        if (config.layout.building.height) {
                            buildingEl.style.height = config.layout.building.height + 'vh';
                        }
                        
                        if (config.layout.building.backgroundColor) {
                            buildingEl.style.backgroundColor = config.layout.building.backgroundColor;
                        }
                    }
                }
                
                console.log('üé® Layout configuration applied');
            }

            // Apply images
            if (config.images) {
                if (config.images.logo) {
                    const logoImg = document.querySelector('img[alt="Canvas 39 Logo"]');
                    if (logoImg) {
                        logoImg.src = config.images.logo;
                        // ‡πÄ‡∏Å‡πá‡∏ö filter ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÑ‡∏ß‡πâ
                        logoImg.style.filter = 'brightness(0) invert(1)';
                        console.log('üñºÔ∏è Logo updated with white filter:', config.images.logo.substring(0, 50) + '...');
                    }
                }
                
                if (config.images.building) {
                    const buildingSection = document.querySelector('[style*="background-image"]');
                    if (buildingSection) {
                        buildingSection.style.backgroundImage = `url('${config.images.building}')`;
                    }
                }
            }

            // Update API configuration
            if (config.weatherApi) {
                WEATHER_API_PROVIDER = config.weatherApi;
            }
            
            if (config.openweatherKey) {
                WEATHER_API_KEY = config.openweatherKey;
            }

            // Update intervals
            if (config.updateInterval) {
                UPDATE_INTERVAL = config.updateInterval * 60 * 1000; // Convert to milliseconds
            }

            // Show notices if any are active
            if (config.notices && config.notices.length > 0) {
                console.log('üì¢ Found notices in config:', config.notices);
                showNotice(config.notices);
            } else {
                console.log('‚ö†Ô∏è No notices found in config');
            }

            console.log('‚úÖ Configuration applied successfully');
        }

        // Show notice with position-based rendering
        function showNotice(notices) {
            console.log('üì¢ showNotice called with:', notices);
            
            // Get containers
            const headerContainer = document.getElementById('headerNotifications');
            const footerContainer = document.getElementById('footerNotifications');
            const overlayContainer = document.getElementById('notificationOverlay');
            const overlayContent = document.getElementById('notificationContent');
            
            // Clear existing notices
            if (headerContainer) headerContainer.innerHTML = '';
            if (footerContainer) footerContainer.innerHTML = '';
            if (overlayContainer) overlayContainer.classList.add('hidden');
            
            // Find active notices
            const activeNotices = notices.filter(notice => notice.active);
            console.log('‚úÖ Active notices found:', activeNotices.length);
            
            if (activeNotices.length === 0) {
                console.log('‚ö†Ô∏è No active notices');
                return;
            }
            
            // Group notices by position
            const noticesByPosition = {
                top: activeNotices.filter(notice => notice.position === 'top'),
                bottom: activeNotices.filter(notice => notice.position === 'bottom'),
                overlay: activeNotices.filter(notice => notice.position === 'overlay' || !notice.position)
            };
            
            // Render header notices
            if (noticesByPosition.top.length > 0 && headerContainer) {
                console.log('üì∫ Showing header notices:', noticesByPosition.top.length);
                headerContainer.classList.remove('hidden');
                noticesByPosition.top.forEach(notice => {
                    const noticeElement = createNoticeElement(notice, 'header');
                    headerContainer.appendChild(noticeElement);
                });
            }
            
            // Render footer notices as single marquee
            if (noticesByPosition.bottom.length > 0 && footerContainer) {
                console.log('üì∫ Showing footer notices:', noticesByPosition.bottom.length);
                footerContainer.classList.remove('hidden');
                
                // Combine all footer notices into one marquee
                const combinedText = noticesByPosition.bottom.map(notice => {
                    const cleanContent = stripHtml(notice.content || '');
                    return `${notice.title || '‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®'}: ${cleanContent}`;
                }).join(' ‚Ä¢ ');
                
                // Get the first notice type for color
                const firstNoticeType = noticesByPosition.bottom[0].type || 'warning';
                const typeColors = {
                    'info': 'bg-blue-500',
                    'warning': 'bg-yellow-500', 
                    'success': 'bg-green-500',
                    'error': 'bg-red-500'
                };
                const bgColor = typeColors[firstNoticeType] || 'bg-yellow-500';
                
                footerContainer.innerHTML = `
                    <div class="${bgColor} text-white h-8 flex items-center">
                        <div class="flex items-center gap-2 animate-marquee whitespace-nowrap">
                            <svg class="w-4 h-4 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                ${getNoticeIcon(firstNoticeType)}
                            </svg>
                            <span class="font-medium text-sm">${combinedText}</span>
                            <span class="mx-8">‚Ä¢</span>
                            <span class="font-medium text-sm">${combinedText}</span>
                            <span class="mx-8">‚Ä¢</span>
                        </div>
                    </div>
                `;
            }
            
            // Render overlay notices (original behavior)
            if (noticesByPosition.overlay.length > 0 && overlayContainer && overlayContent) {
                console.log('üì∫ Showing overlay notice:', noticesByPosition.overlay[0].title);
                overlayContent.innerHTML = noticesByPosition.overlay[0].content;
                overlayContainer.classList.remove('hidden');
            }
        }
        
        // Create notice element for header positioning
        function createNoticeElement(notice, position) {
            const element = document.createElement('div');
            
            // Get type colors
            const typeColors = {
                'info': 'bg-blue-500 border-blue-600',
                'warning': 'bg-yellow-500 border-yellow-600',
                'success': 'bg-green-500 border-green-600',
                'error': 'bg-red-500 border-red-600'
            };
            
            const typeColor = typeColors[notice.type] || 'bg-blue-500 border-blue-600';
            
            // Header style only (footer is handled separately as marquee)
            let className = `${typeColor} text-white px-6 py-3 transition-all duration-300 border-b-2`;
            element.className = className;
            element.innerHTML = `
                <div class="flex items-center justify-between max-w-7xl mx-auto">
                    <div class="flex items-center gap-3">
                        <div class="flex-shrink-0">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                ${getNoticeIcon(notice.type)}
                            </svg>
                        </div>
                        <div>
                            <div class="font-semibold text-sm">${notice.title || '‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®'}</div>
                            <div class="text-xs opacity-90">${stripHtml(notice.content || '')}</div>
                        </div>
                    </div>
                    <button onclick="dismissNotice('${notice.id}')" class="text-white hover:text-gray-200 transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            return element;
        }
        
        // Strip HTML tags for clean text display
        function stripHtml(html) {
            const doc = new DOMParser().parseFromString(html, 'text/html');
            return doc.body.textContent || "";
        }
        
        // Get icon SVG for notice type
        function getNoticeIcon(type) {
            const icons = {
                'info': '<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>',
                'warning': '<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>',
                'success': '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>',
                'error': '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>'
            };
            return icons[type] || icons['info'];
        }
        
        // Dismiss notice function
        function dismissNotice(noticeId) {
            console.log('üóëÔ∏è Dismissing notice:', noticeId);
            // You can implement notice dismissal logic here
            // For now, just hide the notice element
            const noticeElements = document.querySelectorAll(`[onclick="dismissNotice('${noticeId}')"]`);
            noticeElements.forEach(element => {
                const noticeDiv = element.closest('div[class*="bg-"]');
                if (noticeDiv) {
                    noticeDiv.style.display = 'none';
                }
            });
        }

        // Initialize Lucide icons
        lucide.createIcons();
        
        // Configuration defaults
        let WEATHER_API_KEY = 'db61b712294c46506059042663feeac6'; // OpenWeatherMap API Key
        let WEATHER_API_PROVIDER = 'openmeteo'; // Default provider
        let UPDATE_INTERVAL = 10 * 60 * 1000; // 10 minutes
        const CITY = 'Bangkok,TH';
        
        // WeatherAPI.com (Free alternative - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á API key)
        const WEATHER_API_URL = 'https://api.weatherapi.com/v1/current.json?key=demo&q=Bangkok&aqi=no';
        
        // Mock data (fallback)
        const mockData = {
            weather: {
                current: {
                    condition: "Partly Cloudy",
                    high: 34,
                    low: 26
                },
                forecast: [
                    { time: "11:00", condition: "Sunny", icon: "sun", temperature: 32 },
                    { time: "12:00", condition: "Partly Cloudy", icon: "cloud", temperature: 33 },
                    { time: "13:00", condition: "Rainy", icon: "cloud-rain", temperature: 31 },
                    { time: "14:00", condition: "Thunderstorm", icon: "zap", temperature: 29 }
                ]
            },
            airQuality: {
                indoor: { aqi: 40, level: "Good", pollutant: "PM10", concentration: 43.5 },
                outdoor: { aqi: 84, level: "Moderate", pollutant: "PM2.5", concentration: 27 }
            },
            waterQuality: {
                water: { ph: 7.2, chlorine: 1.8 },
                pool: { 
                    ph: 7.4,        // Green (7.2-7.6) OPTIMAL - matches Air Quality Good
                    chlorine: 2.1, 
                    temperature: 25.0,  // Green (20-28¬∞C) OPTIMAL - matches Air Quality Good
                    orp: 700,       // Green (650-750 mV) OPTIMAL - matches Air Quality Good
                    tds: 800        // Green (500-1000 ppm) OPTIMAL - matches Air Quality Good
                }
            }
        };

        function updateFaceIcon(elementId, aqi) {
            const element = document.getElementById(elementId);
            let iconUrl = '';
            
            if (aqi <= 50) {
                iconUrl = 'https://www.iqair.com/dl/assets/aqi/ic-face-green.svg';
            } else if (aqi <= 100) {
                iconUrl = 'https://www.iqair.com/dl/assets/aqi/ic-face-yellow.svg';
            } else if (aqi <= 150) {
                iconUrl = 'https://www.iqair.com/dl/assets/aqi/ic-face-orange.svg';
            } else if (aqi <= 200) {
                iconUrl = 'https://www.iqair.com/dl/assets/aqi/ic-face-red.svg';
            } else {
                iconUrl = 'https://www.iqair.com/dl/assets/aqi/ic-face-purple.svg';
            }
            
            // ‡πÉ‡∏ä‡πâ filter brightness-0 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏î‡∏≥
            element.innerHTML = `<img src="${iconUrl}" alt="AQI Face" class="w-full h-full object-contain filter brightness-0">`;
        }
        
        // Water Quality Color Functions - Match Air Quality Theme
        function getTemperatureColor(temp) {
            if (temp >= 20 && temp <= 28) return { color: '#22c55e', status: 'OPTIMAL' }; // Green-500 (same as Air Quality good)
            if ((temp >= 28 && temp <= 30) || (temp >= 18 && temp < 20)) return { color: '#eab308', status: 'CAUTION' }; // Yellow-500 (same as Air Quality moderate)
            return { color: '#dc2626', status: 'DANGER' }; // Red-600 (same as Air Quality bad)
        }
        
        function getPHColor(ph) {
            if (ph >= 7.2 && ph <= 7.6) return { color: '#22c55e', status: 'OPTIMAL' }; // Green-500
            if ((ph >= 7.0 && ph < 7.2) || (ph > 7.6 && ph <= 7.8)) return { color: '#eab308', status: 'CAUTION' }; // Yellow-500
            return { color: '#dc2626', status: 'DANGER' }; // Red-600
        }
        
        function getORPColor(orp) {
            if (orp >= 650 && orp <= 750) return { color: '#22c55e', status: 'OPTIMAL' }; // Green-500
            if (orp >= 600 && orp < 650) return { color: '#eab308', status: 'CAUTION' }; // Yellow-500
            return { color: '#dc2626', status: 'DANGER' }; // Red-600
        }
        
        function getTDSColor(tds) {
            if (tds >= 500 && tds <= 1000) return { color: '#22c55e', status: 'OPTIMAL' }; // Green-500
            if (tds > 1000 && tds <= 1500) return { color: '#eab308', status: 'CAUTION' }; // Yellow-500
            return { color: '#dc2626', status: 'DANGER' }; // Red-600
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AQI ‡∏à‡∏≤‡∏Å IQAir Canvas 39 (‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ)
        async function fetchCanvas39AQI() {
            // ‡∏•‡∏¥‡∏™‡∏ï‡πå proxy servers ‡∏ó‡∏µ‡πà‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
            const proxies = [
                'https://cors-anywhere.herokuapp.com/',
                'https://corsproxy.io/?',
                'https://api.codetabs.com/v1/proxy?quest='
            ];
            
            const targetUrl = 'https://www.iqair.com/thailand/bangkok/bangkok/canvas-39';
            
            for (const proxy of proxies) {
                try {
                    console.log(`üîÑ ‡∏•‡∏≠‡∏á proxy: ${proxy}`);
                    
                    const response = await fetch(proxy + encodeURIComponent(targetUrl), {
                        headers: {
                            'X-Requested-With': 'XMLHttpRequest'
                        }
                    });
                    
                    if (!response.ok) continue;
                    
                    const htmlContent = await response.text();
                    
                    // Extract AQI data ‡∏à‡∏≤‡∏Å HTML (regex pattern)
                    const aqiMatch = htmlContent.match(/aqi[":]*\s*(\d+)/i);
                    const levelMatch = htmlContent.match(/status[":]*\s*["']([^"']+)["']/i);
                    const pollutantMatch = htmlContent.match(/pollutant[":]*\s*["']([^"']+)["']/i);
                    const concentrationMatch = htmlContent.match(/concentration[":]*\s*(\d+\.?\d*)/i);
                    
                    if (aqiMatch) {
                        const aqiData = {
                            aqi: parseInt(aqiMatch[1]),
                            level: levelMatch ? levelMatch[1] : 'Unknown',
                            pollutant: pollutantMatch ? pollutantMatch[1] : 'PM2.5',
                            concentration: concentrationMatch ? parseFloat(concentrationMatch[1]) : 0
                        };
                        
                        console.log('‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AQI Canvas 39 ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', aqiData);
                        return aqiData;
                    }
                    
                } catch (error) {
                    console.log(`‚ùå Proxy ${proxy} ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:`, error.message);
                    continue;
                }
            }
            
            // ‡∏ñ‡πâ‡∏≤ scraping ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏ä‡πâ IQAir API ‡∏™‡∏≥‡∏£‡∏≠‡∏á
            try {
                console.log('üîÑ ‡∏•‡∏≠‡∏á IQAir API ‡∏™‡∏≥‡∏£‡∏≠‡∏á...');
                const response = await fetch(
                    'https://api.airvisual.com/v2/city?city=Bangkok&state=Bangkok&country=Thailand&key=demo'
                );
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.status === 'success') {
                        const aqiData = {
                            aqi: data.data.current.pollution.aqius,
                            level: getAQILevel(data.data.current.pollution.aqius),
                            pollutant: 'PM2.5',
                            concentration: data.data.current.pollution.aqius
                        };
                        
                        console.log('‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AQI ‡∏à‡∏≤‡∏Å IQAir API ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', aqiData);
                        return aqiData;
                    }
                }
            } catch (error) {
                console.log('‚ùå IQAir API ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', error.message);
            }
            
            console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AQI ‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ ‡πÉ‡∏ä‡πâ mock data');
            return null;
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á AQI ‡πÄ‡∏õ‡πá‡∏ô level
        function getAQILevel(aqi) {
            if (aqi <= 50) return 'Good';
            else if (aqi <= 100) return 'Moderate';
            else if (aqi <= 150) return 'Unhealthy for Sensitive Groups';
            else if (aqi <= 200) return 'Unhealthy';
            else if (aqi <= 300) return 'Very Unhealthy';
            else return 'Hazardous';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏à‡∏≤‡∏Å OpenMeteo (‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤)
        async function fetchOpenMeteoWeather() {
            // Allow execution even if not the primary provider (for fallback)
            if (WEATHER_API_PROVIDER !== 'openmeteo' && arguments[0] !== 'fallback') return null;
            
            try {
                // Bangkok coordinates
                const lat = 13.7563;
                const lng = 100.5018;
                
                const response = await fetch(
                    `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lng}&current=temperature_2m,weather_code,relative_humidity_2m,wind_speed_10m&hourly=temperature_2m,weather_code&timezone=Asia%2FBangkok&forecast_days=1`
                );
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('üå°Ô∏è OpenMeteo Raw Data:', data);
                
                const current = data.current;
                const hourly = data.hourly;
                
                const processedData = {
                    weather: {
                        current: {
                            condition: mapOpenMeteoWeatherCode(current.weather_code),
                            high: Math.round(current.temperature_2m + 3),
                            low: Math.round(current.temperature_2m - 3)
                        },
                        forecast: hourly.time.slice(1, 5).map((time, index) => {
                            const hour = new Date(time).toLocaleTimeString('th-TH', {
                                hour: '2-digit',
                                minute: '2-digit',
                                hour12: false
                            });
                            return {
                                time: hour,
                                condition: mapOpenMeteoWeatherCode(hourly.weather_code[index + 1]),
                                temperature: Math.round(hourly.temperature_2m[index + 1])
                            };
                        })
                    }
                };
                
                console.log('‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• OpenMeteo ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', processedData);
                console.log('üìä ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:', current.temperature_2m, '¬∞C');
                console.log('üí® ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô:', current.relative_humidity_2m, '%');
                console.log('üå¨Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏•‡∏°:', current.wind_speed_10m, 'km/h');
                console.log('‚è∞ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠:', new Date().toLocaleTimeString('th-TH'));
                
                return processedData;
                
            } catch (error) {
                console.error('‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î OpenMeteo API:', error);
                return null;
            }
        }
        
        // ‡πÅ‡∏õ‡∏•‡∏á weather code ‡∏Ç‡∏≠‡∏á OpenMeteo
        function mapOpenMeteoWeatherCode(code) {
            const codeMap = {
                0: 'Sunny',           // Clear sky
                1: 'Sunny',           // Mainly clear
                2: 'Partly Cloudy',   // Partly cloudy
                3: 'Partly Cloudy',   // Overcast
                45: 'Partly Cloudy',  // Fog
                48: 'Partly Cloudy',  // Depositing rime fog
                51: 'Rainy',          // Drizzle: Light
                53: 'Rainy',          // Drizzle: Moderate
                55: 'Rainy',          // Drizzle: Dense
                61: 'Rainy',          // Rain: Slight
                63: 'Rainy',          // Rain: Moderate
                65: 'Rainy',          // Rain: Heavy
                80: 'Rainy',          // Rain showers: Slight
                81: 'Rainy',          // Rain showers: Moderate
                82: 'Rainy',          // Rain showers: Violent
                95: 'Thunderstorm',   // Thunderstorm: Slight
                96: 'Thunderstorm',   // Thunderstorm with hail
                99: 'Thunderstorm'    // Thunderstorm with heavy hail
            };
            return codeMap[code] || 'Partly Cloudy';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á API Key (wttr.in backup)
        async function fetchFreeWeatherData() {
            // Allow execution even if not the primary provider (for fallback)
            if (WEATHER_API_PROVIDER !== 'wttr' && arguments[0] !== 'fallback') return null;
            
            try {
                // ‡πÉ‡∏ä‡πâ wttr.in - free weather API ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á key
                const response = await fetch('https://wttr.in/Bangkok?format=j1');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('üå°Ô∏è Free Weather Raw Data:', data);
                
                const current = data.current_condition[0];
                const today = data.weather[0];
                
                const processedData = {
                    weather: {
                        current: {
                            condition: mapWttrWeatherCondition(current.weatherCode),
                            high: Math.round(parseFloat(today.maxtempC)),
                            low: Math.round(parseFloat(today.mintempC))
                        },
                        forecast: data.weather[0].hourly.slice(0, 4).map((hour, index) => {
                            const time = String((new Date().getHours() + index + 1) % 24).padStart(2, '0') + ':00';
                            return {
                                time: time,
                                condition: mapWttrWeatherCondition(hour.weatherCode),
                                temperature: Math.round(parseFloat(hour.tempC))
                            };
                        })
                    }
                };
                
                console.log('‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏£‡∏µ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', processedData);
                console.log('üìä ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:', current.temp_C, '¬∞C');
                console.log('üí® ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô:', current.humidity, '%');
                console.log('üå¨Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏•‡∏°:', current.windspeedKmph, 'km/h');
                console.log('‚è∞ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠:', new Date().toLocaleTimeString('th-TH'));
                
                return processedData;
                
            } catch (error) {
                console.error('‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î Free Weather API:', error);
                return null;
            }
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AQI ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å API
        async function fetchRealAQIData() {
            try {
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Vercel static hosting - ‡πÉ‡∏ä‡πâ direct API calls
                // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å PHP ‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÉ‡∏ô Vercel static hosting
                
                // ‡∏•‡∏≠‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Indoor AQI ‡∏à‡∏≤‡∏Å Device API
                const indoorData = await fetchIndoorAQI();
                
                // ‡∏•‡∏≠‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Outdoor AQI ‡∏à‡∏≤‡∏Å Canvas 39
                const outdoorData = await fetchCanvas39AQI();
                
                if (indoorData || outdoorData) {
                    return {
                        indoor: indoorData || {
                            aqi: 40,
                            level: "Good",
                            pollutant: "PM10", 
                            concentration: 43.5
                        },
                        outdoor: outdoorData || {
                            aqi: 84,
                            level: "Moderate",
                            pollutant: "PM2.5",
                            concentration: 27
                        }
                    };
                }
                
                return null;

            } catch (error) {
                console.error('‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î AQI API:', error);
                return null;
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Indoor AQI
        async function fetchIndoorAQI() {
            try {
                const response = await fetch('https://device.iqair.com/v2/6790850e7307e18fb3e0c815/validated-data', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Cache-Control': 'no-cache'
                    }
                });

                if (!response.ok) {
                    throw new Error(`Indoor AQI API error: ${response.status}`);
                }

                const data = await response.json();
                console.log('üìä Indoor AQI Data:', data);

                // Parse response format
                if (data.current) {
                    const current = data.current;
                    const aqi = current.aqius || current.pm25?.aqius || 40;
                    
                    return {
                        aqi: aqi,
                        level: getAQILevel(aqi),
                        pollutant: "PM2.5",
                        concentration: current.pm25?.v || current.pm25?.conc || 25
                    };
                }

                return null;

            } catch (error) {
                console.log('‚ùå Indoor AQI API ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', error.message);
                return null;
            }
        }

        // ‡πÅ‡∏õ‡∏•‡∏á weather code ‡∏Ç‡∏≠‡∏á wttr.in ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®
        function mapWttrWeatherCondition(weatherCode) {
            const conditionMap = {
                '113': 'Sunny',         // Clear/Sunny
                '116': 'Partly Cloudy', // Partly cloudy
                '119': 'Partly Cloudy', // Cloudy
                '122': 'Partly Cloudy', // Overcast
                '143': 'Partly Cloudy', // Mist
                '176': 'Rainy',         // Patchy rain possible
                '179': 'Rainy',         // Patchy snow possible
                '182': 'Rainy',         // Patchy sleet possible
                '185': 'Rainy',         // Patchy freezing drizzle possible
                '200': 'Thunderstorm',  // Thundery outbreaks possible
                '227': 'Rainy',         // Blowing snow
                '230': 'Rainy',         // Blizzard
                '248': 'Partly Cloudy', // Fog
                '260': 'Partly Cloudy', // Freezing fog
                '263': 'Rainy',         // Patchy light drizzle
                '266': 'Rainy',         // Light drizzle
                '281': 'Rainy',         // Freezing drizzle
                '284': 'Rainy',         // Heavy freezing drizzle
                '293': 'Rainy',         // Patchy light rain
                '296': 'Rainy',         // Light rain
                '299': 'Rainy',         // Moderate rain at times
                '302': 'Rainy',         // Moderate rain
                '305': 'Rainy',         // Heavy rain at times
                '308': 'Rainy',         // Heavy rain
                '311': 'Rainy',         // Light freezing rain
                '314': 'Rainy',         // Moderate or heavy freezing rain
                '317': 'Rainy',         // Light sleet
                '320': 'Rainy',         // Moderate or heavy sleet
                '323': 'Rainy',         // Patchy light snow
                '326': 'Rainy',         // Light snow
                '329': 'Rainy',         // Patchy moderate snow
                '332': 'Rainy',         // Moderate snow
                '335': 'Rainy',         // Patchy heavy snow
                '338': 'Rainy',         // Heavy snow
                '350': 'Rainy',         // Ice pellets
                '353': 'Rainy',         // Light rain shower
                '356': 'Rainy',         // Moderate or heavy rain shower
                '359': 'Rainy',         // Torrential rain shower
                '362': 'Rainy',         // Light sleet showers
                '365': 'Rainy',         // Moderate or heavy sleet showers
                '368': 'Rainy',         // Light snow showers
                '371': 'Rainy',         // Moderate or heavy snow showers
                '374': 'Rainy',         // Light showers of ice pellets
                '377': 'Rainy',         // Moderate or heavy showers of ice pellets
                '386': 'Thunderstorm',  // Patchy light rain with thunder
                '389': 'Thunderstorm',  // Moderate or heavy rain with thunder
                '392': 'Thunderstorm',  // Patchy light snow with thunder
                '395': 'Thunderstorm'   // Moderate or heavy snow with thunder
            };
            return conditionMap[weatherCode] || 'Partly Cloudy';
        }
        
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á forecast ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        function generateMockForecast(currentTemp) {
            const hours = [];
            const now = new Date();
            
            for (let i = 1; i <= 4; i++) {
                const futureTime = new Date(now.getTime() + (i * 60 * 60 * 1000));
                const timeString = futureTime.toLocaleTimeString('th-TH', {
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: false
                });
                
                // ‡∏™‡∏∏‡πà‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏à‡∏£‡∏¥‡∏á ¬±2¬∞C
                const tempVariation = (Math.random() - 0.5) * 4;
                const temperature = Math.round(currentTemp + tempVariation);
                
                // ‡∏™‡∏∏‡πà‡∏°‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®
                const conditions = ['Sunny', 'Partly Cloudy', 'Rainy'];
                const condition = conditions[Math.floor(Math.random() * conditions.length)];
                
                hours.push({
                    time: timeString,
                    condition: condition,
                    temperature: temperature
                });
            }
            
            return hours;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏à‡∏≤‡∏Å OpenWeatherMap
        async function fetchRealWeatherData() {
            // Allow execution even if not the primary provider (for fallback)
            if (WEATHER_API_PROVIDER !== 'openweather' && arguments[0] !== 'fallback') return null;
            
            if (WEATHER_API_KEY === 'YOUR_API_KEY_HERE') {
                console.log('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà API Key ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö OpenWeatherMap');
                return null;
            }
            
            try {
                // Current Weather
                const currentResponse = await fetch(
                    `https://api.openweathermap.org/data/2.5/weather?q=${CITY}&appid=${WEATHER_API_KEY}&units=metric`
                );
                
                if (!currentResponse.ok) {
                    throw new Error(`HTTP error! status: ${currentResponse.status}`);
                }
                
                const currentData = await currentResponse.json();
                
                // Forecast Weather (5 day / 3 hour)
                const forecastResponse = await fetch(
                    `https://api.openweathermap.org/data/2.5/forecast?q=${CITY}&appid=${WEATHER_API_KEY}&units=metric&cnt=4`
                );
                
                const forecastData = await forecastResponse.json();
                
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°
                const weatherCondition = mapWeatherCondition(currentData.weather[0].main);
                
                const processedData = {
                    weather: {
                        current: {
                            condition: weatherCondition,
                            high: Math.round(currentData.main.temp_max),
                            low: Math.round(currentData.main.temp_min)
                        },
                        forecast: forecastData.list.map(item => {
                            const time = new Date(item.dt * 1000).toLocaleTimeString('th-TH', {
                                hour: '2-digit',
                                minute: '2-digit',
                                hour12: false
                            });
                            return {
                                time: time,
                                condition: mapWeatherCondition(item.weather[0].main),
                                temperature: Math.round(item.main.temp)
                            };
                        })
                    }
                };
                
                console.log('‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏à‡∏£‡∏¥‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', processedData);
                console.log('üìä ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:', currentData.main.temp, '¬∞C');
                console.log('üå§Ô∏è ‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®:', currentData.weather[0].description);
                console.log('üí® ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô:', currentData.main.humidity, '%');
                return processedData;
                
            } catch (error) {
                console.error('‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®:', error);
                return null;
            }
        }
        
        // ‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏à‡∏≤‡∏Å OpenWeatherMap ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ
        function mapWeatherCondition(openWeatherCondition) {
            const conditionMap = {
                'Clear': 'Sunny',
                'Clouds': 'Partly Cloudy',
                'Rain': 'Rainy',
                'Drizzle': 'Rainy',
                'Thunderstorm': 'Thunderstorm',
                'Snow': 'Rainy', // ‡πÉ‡∏ä‡πâ rain icon ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏¥‡∏°‡∏∞
                'Mist': 'Partly Cloudy',
                'Fog': 'Partly Cloudy'
            };
            return conditionMap[openWeatherCondition] || 'Partly Cloudy';
        }

        function getWeatherIcon(condition) {
            const iconMap = {
                'Sunny': 'sun',
                'Partly Cloudy': 'cloud',
                'Rainy': 'cloud-rain',
                'Thunderstorm': 'zap'
            };
            
            const animationClass = {
                'Sunny': 'weather-icon-sun',
                'Partly Cloudy': 'weather-icon-cloud',
                'Rainy': 'weather-icon-rain',
                'Thunderstorm': 'weather-icon-thunder'
            }[condition] || 'weather-icon-cloud';
            
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®
            const colorMap = {
                'Sunny': '#FFB800',           // ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏ó‡∏≠‡∏á (‡πÅ‡∏î‡∏î)
                'Partly Cloudy': '#6B7280',  // ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤ (‡πÄ‡∏°‡∏Ü)
                'Rainy': '#3B82F6',          // ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô (‡∏ù‡∏ô)
                'Thunderstorm': '#8B5CF6'    // ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á (‡∏û‡∏≤‡∏¢‡∏∏)
            };
            
            const iconName = iconMap[condition] || 'cloud';
            const iconColor = colorMap[condition] || '#6B7280';
            
            return `<i data-feather="${iconName}" class="w-full h-full ${animationClass}" style="stroke: ${iconColor}; stroke-width: 2;"></i>`;
        }

        function updateDateTime() {
            const now = new Date();
            
            const timeString = now.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: false,
                timeZone: 'Asia/Bangkok'
            });
            document.getElementById('currentTime').textContent = timeString;
            
            const dateString = now.toLocaleDateString('en-US', { 
                weekday: 'long', 
                day: 'numeric', 
                month: 'long',
                timeZone: 'Asia/Bangkok'
            });
            document.getElementById('currentDate').textContent = dateString;
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log('Error attempting to enable fullscreen:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }

        async function updateDisplay(displayConfig = null) {
            console.log('üîÑ Updating display...');
            const startTime = Date.now();
            
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å API provider ‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            let realWeatherData = null;
            
            if (WEATHER_API_PROVIDER === 'openmeteo') {
                realWeatherData = await fetchOpenMeteoWeather();
            } else if (WEATHER_API_PROVIDER === 'wttr') {
                realWeatherData = await fetchFreeWeatherData();
            } else if (WEATHER_API_PROVIDER === 'openweather') {
                realWeatherData = await fetchRealWeatherData();
            }
            
            // ‡∏ñ‡πâ‡∏≤ provider ‡∏´‡∏•‡∏±‡∏Å‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏•‡∏≠‡∏á fallback
            if (!realWeatherData) {
                console.log('‚ö†Ô∏è Primary weather API ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏•‡∏≠‡∏á fallback...');
                
                // ‡∏•‡∏≠‡∏á OpenMeteo ‡∏Å‡πà‡∏≠‡∏ô (‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
                if (WEATHER_API_PROVIDER !== 'openmeteo') {
                    realWeatherData = await fetchOpenMeteoWeather('fallback');
                }
                
                // ‡∏•‡∏≠‡∏á wttr.in
                if (!realWeatherData && WEATHER_API_PROVIDER !== 'wttr') {
                    realWeatherData = await fetchFreeWeatherData('fallback');
                }
                
                // ‡∏•‡∏≠‡∏á OpenWeatherMap ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
                if (!realWeatherData && WEATHER_API_PROVIDER !== 'openweather') {
                    realWeatherData = await fetchRealWeatherData('fallback');
                }
            }
            
            const weather = realWeatherData ? realWeatherData.weather : mockData.weather;
            
            // ‡∏•‡∏≠‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AQI ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å API
            let airQuality = mockData.airQuality;
            try {
                const realAQIData = await fetchRealAQIData();
                if (realAQIData) {
                    airQuality = realAQIData;
                    console.log('‚úÖ ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AQI ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å API');
                } else {
                    console.log('‚ö†Ô∏è ‡πÉ‡∏ä‡πâ Mock AQI Data ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å API ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                }
            } catch (error) {
                console.log('‚ùå AQI API Error:', error.message);
                console.log('üìä ‡πÉ‡∏ä‡πâ Mock AQI Data ‡πÅ‡∏ó‡∏ô');
            }
            
            if (realWeatherData) {
                console.log('üéØ ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Weather API');
            } else {
                console.log('‚ö†Ô∏è ‡πÉ‡∏ä‡πâ Mock Data ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Weather APIs ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
            }
            // Update weather elements (check if they exist)
            const lowTemp = document.getElementById('lowTemp');
            const highTemp = document.getElementById('highTemp');
            if (lowTemp) lowTemp.textContent = weather.current.low + '¬∞C';
            if (highTemp) highTemp.textContent = weather.current.high + '¬∞C';
            
            // Update today's weather icon
            const todayIconContainer = document.getElementById('todayIcon');
            if (todayIconContainer) {
                todayIconContainer.innerHTML = getWeatherIcon(weather.current.condition);
            }
            
            // Update forecast
            const forecastGrid = document.getElementById('forecastGrid');
            if (forecastGrid) {
                forecastGrid.innerHTML = '';
                
                weather.forecast.forEach(item => {
                const forecastItem = document.createElement('div');
                forecastItem.className = 'text-center flex flex-col items-center justify-center h-16 sm:h-20';
                forecastItem.innerHTML = `
                    <div class="w-8 h-8 sm:w-12 sm:h-12 mb-1">
                        ${getWeatherIcon(item.condition)}
                    </div>
                    <div class="text-lg font-medium" style="color: #3f2f15;">${item.time}</div>
                `;
                    forecastGrid.appendChild(forecastItem);
                });
            }
            
            // Update AQI
            document.getElementById('indoorAQI').textContent = airQuality.indoor.aqi;
            document.getElementById('indoorLevel').textContent = airQuality.indoor.level;
            document.getElementById('indoorPollutant').textContent = airQuality.indoor.pollutant;
            document.getElementById('indoorConcentration').textContent = airQuality.indoor.concentration;
            
            document.getElementById('outdoorAQI').textContent = airQuality.outdoor.aqi;
            document.getElementById('outdoorLevel').textContent = airQuality.outdoor.level;
            document.getElementById('outdoorPollutant').textContent = airQuality.outdoor.pollutant;
            document.getElementById('outdoorConcentration').textContent = airQuality.outdoor.concentration;
            
            // Update face icons based on AQI levels
            updateFaceIcon('indoorFace', airQuality.indoor.aqi);
            updateFaceIcon('outdoorFace', airQuality.outdoor.aqi);
            
            // Update water quality
            const waterQuality = mockData.waterQuality;
            
            // Update pool water quality elements with color coding
            const poolTemp = document.getElementById('poolTemperature');
            const poolPH = document.getElementById('poolPH');
            const poolChlorine = document.getElementById('poolChlorine');
            const poolORP = document.getElementById('poolORP');
            const poolTDS = document.getElementById('poolTDS');
            
            // Temperature
            if (poolTemp) {
                const temp = parseFloat(waterQuality.pool.temperature || '27.5');
                const tempColor = getTemperatureColor(temp);
                poolTemp.textContent = temp;
                const tempCard = poolTemp.closest('.bg-blue-500');
                if (tempCard) {
                    tempCard.style.backgroundColor = tempColor.color;
                    const statusEl = tempCard.querySelector('.text-xs.opacity-80');
                    if (statusEl) statusEl.textContent = tempColor.status;
                }
            }
            
            // pH
            if (poolPH) {
                const ph = parseFloat(waterQuality.pool.ph);
                const phColor = getPHColor(ph);
                poolPH.textContent = ph;
                const phCard = poolPH.closest('.bg-green-500');
                if (phCard) {
                    phCard.style.backgroundColor = phColor.color;
                    const statusEl = phCard.querySelector('.text-xs.opacity-80');
                    if (statusEl) statusEl.textContent = phColor.status;
                }
            }
            
            // ORP
            if (poolORP) {
                const orp = parseFloat(waterQuality.pool.orp || '720');
                const orpColor = getORPColor(orp);
                poolORP.textContent = orp;
                const orpCard = poolORP.closest('.bg-purple-500');
                if (orpCard) {
                    orpCard.style.backgroundColor = orpColor.color;
                    const statusEl = orpCard.querySelector('.text-xs.opacity-80');
                    if (statusEl) statusEl.textContent = orpColor.status;
                }
            }
            
            // TDS
            if (poolTDS) {
                const tds = parseFloat(waterQuality.pool.tds || '450');
                const tdsColor = getTDSColor(tds);
                poolTDS.textContent = tds;
                const tdsCard = poolTDS.closest('.bg-orange-500');
                if (tdsCard) {
                    tdsCard.style.backgroundColor = tdsColor.color;
                    const statusEl = tdsCard.querySelector('.text-xs.opacity-80');
                    if (statusEl) statusEl.textContent = tdsColor.status;
                }
            }
            
            // Legacy chlorine (for backward compatibility)
            if (poolChlorine) poolChlorine.textContent = waterQuality.pool.chlorine;
            
            // Legacy elements (may not exist in slideshow version)
            const waterPH = document.getElementById('waterPH');
            const waterChlorine = document.getElementById('waterChlorine');
            if (waterPH) waterPH.textContent = waterQuality.water.ph;
            if (waterChlorine) waterChlorine.textContent = waterQuality.water.chlorine;
            
            // Update slideshow configuration
            if (displayConfig) {
                updateSlideshowConfig(displayConfig);
            }
            
            // Reinitialize icons
            lucide.createIcons();
            feather.replace();
            
            console.log('‚úÖ Display updated successfully');
            
            // Update monitoring stats
            const duration = Date.now() - startTime;
            updateMonitoringStats('weather-update', duration);
            if (airQuality !== mockData.airQuality) {
                updateMonitoringStats('aqi-update');
            }
        }

        // Initialize
        // Periodically check for config updates from JSONBin.io and Firebase backup
        async function checkConfigUpdates() {
            let newConfig = null;
            
            // ‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏à‡∏≤‡∏Å JSONBin.io ‡∏Å‡πà‡∏≠‡∏ô (Primary)
            try {
                console.log('üîÑ Checking for config updates from JSONBin.io...');
                
                const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_CONFIG.binId}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Access-Key': JSONBIN_CONFIG.accessKey
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    newConfig = result.record;
                    console.log('üì¶ Config checked from JSONBin.io');
                }
            } catch (error) {
                console.error('‚ùå Failed to check JSONBin.io updates:', error);
            }
            
            // ‡∏ñ‡πâ‡∏≤ JSONBin.io ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏•‡∏≠‡∏á Firebase backup
            if (!newConfig && window.firebaseDB && window.firebaseGet && window.firebaseRef) {
                try {
                    console.log('üîÑ Checking for config updates from Firebase backup...');
                    const snapshot = await window.firebaseGet(window.firebaseRef(window.firebaseDB, 'canvas39-config'));
                    
                    if (snapshot.exists()) {
                        newConfig = snapshot.val();
                        console.log('üî• Config checked from Firebase backup');
                    }
                } catch (error) {
                    console.error('‚ùå Failed to check Firebase backup updates:', error);
                }
            }
            
            // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö localStorage
            if (newConfig) {
                const cachedConfig = localStorage.getItem('canvas39_admin_config');
                if (cachedConfig) {
                    const oldConfig = JSON.parse(cachedConfig);
                    
                    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    if (JSON.stringify(newConfig) !== JSON.stringify(oldConfig)) {
                        console.log('üÜï Config updated! Applying new configuration...');
                        
                        // ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ logo ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                        const logoChanged = newConfig.images?.logo !== oldConfig.images?.logo;
                        if (logoChanged) {
                            console.log('üñºÔ∏è Logo changed detected!');
                        }
                        
                        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï localStorage
                        localStorage.setItem('canvas39_admin_config', JSON.stringify(newConfig));
                        
                        // Apply configuration ‡πÉ‡∏´‡∏°‡πà
                        applyConfig(newConfig);
                        updateMonitoringStats('config-update');
                    } else {
                        console.log('‚úÖ Config is up to date');
                    }
                }
            } else {
                console.log('‚ö†Ô∏è No config source available for update check');
            }
        }

        // Swiper.js slideshow functionality
        let swiper = null;
        let slideshowConfig = {
            enabled: true,
            interval: 10000, // 10 seconds default
            autoPlay: true
        };

        function initializeSwiper() {
            console.log('üé¨ Initializing Swiper.js slideshow...');
            
            // Make sure Swiper is available
            if (typeof Swiper === 'undefined') {
                console.error('‚ùå Swiper.js not loaded');
                return;
            }

            const swiperContainer = document.querySelector('.quality-slideshow');
            if (!swiperContainer) {
                console.error('‚ùå Swiper container not found');
                return;
            }

            // Initialize Swiper with configuration
            swiper = new Swiper('.quality-slideshow', {
                // Basic settings
                direction: 'horizontal',
                loop: slideshowConfig.loopMode,
                speed: slideshowConfig.speed,
                
                // Auto-play configuration
                autoplay: slideshowConfig.enabled && slideshowConfig.autoPlay ? {
                    delay: slideshowConfig.interval,
                    disableOnInteraction: false,
                    pauseOnMouseEnter: false,
                    reverseDirection: false
                } : false,

                // Touch/swipe settings for tablet
                touchRatio: slideshowConfig.touchEnabled ? 1 : 0,
                touchAngle: 45,
                grabCursor: slideshowConfig.touchEnabled,
                allowTouchMove: slideshowConfig.touchEnabled,
                
                // Transition effects
                effect: slideshowConfig.transition,
                
                // Effect-specific settings
                fadeEffect: {
                    crossFade: true
                },
                cubeEffect: {
                    shadow: true,
                    slideShadows: true,
                    shadowOffset: 20,
                    shadowScale: 0.94
                },
                coverflowEffect: {
                    rotate: 50,
                    stretch: 0,
                    depth: 100,
                    modifier: 1,
                    slideShadows: true
                },
                
                // No pagination dots needed
                pagination: false,
                
                // No navigation arrows needed
                navigation: false,

                // Events
                on: {
                    slideChange: function () {
                        console.log('üîÑ Swiper slide changed to:', this.activeIndex);
                        updateMonitoringStats('slideshow-change');
                    },
                    autoplayStart: function () {
                        console.log('‚ñ∂Ô∏è Swiper autoplay started');
                    },
                    autoplayStop: function () {
                        console.log('‚è∏Ô∏è Swiper autoplay stopped');
                    },
                    touchStart: function () {
                        console.log('üëÜ Touch interaction detected');
                    }
                }
            });

            console.log('‚úÖ Swiper slideshow initialized successfully');
            return swiper;
        }

        function updateSlideshowConfig(config) {
            if (config.slideshow) {
                slideshowConfig.enabled = config.slideshow.enabled !== false; // Default true
                slideshowConfig.interval = (config.slideshow.interval || 10) * 1000; // Convert to milliseconds
                slideshowConfig.showAirQuality = config.slideshow.showAirQuality !== false; // Default true
                slideshowConfig.showPoolWater = config.slideshow.showPoolWater !== false; // Default true
                slideshowConfig.autoPlay = config.slideshow.autoPlay !== false; // Default true
                slideshowConfig.touchEnabled = config.slideshow.touchEnabled !== false; // Default true
                slideshowConfig.loopMode = config.slideshow.loopMode !== false; // Default true
                slideshowConfig.transition = config.slideshow.transition || 'slide'; // slide, fade, cube, coverflow
                slideshowConfig.speed = config.slideshow.speed || 1000; // milliseconds
                
                // Hide/show slides based on configuration
                const airQualitySlide = document.querySelector('.swiper-slide:first-child');
                const poolWaterSlide = document.querySelector('.swiper-slide:last-child');
                
                if (airQualitySlide) {
                    airQualitySlide.style.display = slideshowConfig.showAirQuality ? 'flex' : 'none';
                }
                if (poolWaterSlide) {
                    poolWaterSlide.style.display = slideshowConfig.showPoolWater ? 'flex' : 'none';
                }
                
                // Update Swiper if already initialized
                if (swiper) {
                    // Destroy and recreate for major config changes
                    const shouldRecreate = swiper.params.effect !== slideshowConfig.transition ||
                                         swiper.params.speed !== slideshowConfig.speed ||
                                         swiper.params.touchRatio !== (slideshowConfig.touchEnabled ? 1 : 0);
                    
                    if (shouldRecreate) {
                        swiper.destroy(true, true);
                        setTimeout(() => {
                            initializeSwiper();
                        }, 100);
                    } else {
                        // Update existing configuration
                        if (slideshowConfig.enabled && slideshowConfig.autoPlay) {
                            if (swiper.params.autoplay) {
                                swiper.params.autoplay.delay = slideshowConfig.interval;
                            }
                            swiper.autoplay.start();
                        } else {
                            swiper.autoplay.stop();
                        }
                        
                        // Update touch settings
                        swiper.params.touchRatio = slideshowConfig.touchEnabled ? 1 : 0;
                        swiper.allowTouchMove = slideshowConfig.touchEnabled;
                    }
                }
                
                console.log('üé¨ Swiper config updated:', slideshowConfig);
            }
        }

        function stopSlideshow() {
            if (swiper && swiper.autoplay) {
                swiper.autoplay.stop();
                console.log('‚è∏Ô∏è Swiper slideshow stopped');
            }
        }

        function startSlideshow() {
            if (swiper && swiper.autoplay && slideshowConfig.enabled && slideshowConfig.autoPlay) {
                swiper.autoplay.start();
                console.log('‚ñ∂Ô∏è Swiper slideshow started');
            }
        }

        function restartSlideshow() {
            if (swiper) {
                stopSlideshow();
                startSlideshow();
                console.log('üîÑ Swiper slideshow restarted');
            }
        }

        // Admin Panel Integration Functions
        let adminConfig = {};
        let layoutConfig = {};
        // slideshowConfig already declared above - no need to redeclare
        let customSlides = [];
        let notifications = [];

        // Load admin panel configuration
        async function loadAdminConfig() {
            console.log('üîß Loading admin panel configuration...');
            
            try {
                // Load main admin config
                const savedAdminConfig = localStorage.getItem('canvas39_admin_config');
                if (savedAdminConfig) {
                    adminConfig = JSON.parse(savedAdminConfig);
                    console.log('üìã Loaded admin config:', adminConfig);
                }

                // Load layout config
                const savedLayoutConfig = localStorage.getItem('canvas39_layout_config');
                if (savedLayoutConfig) {
                    layoutConfig = JSON.parse(savedLayoutConfig);
                    console.log('üéõÔ∏è Loaded layout config:', layoutConfig);
                }

                // Load custom slides
                const savedCustomSlides = localStorage.getItem('canvas39_slides');
                if (savedCustomSlides) {
                    customSlides = JSON.parse(savedCustomSlides);
                    console.log('üé¨ Loaded custom slides:', customSlides);
                }

                // Load notifications
                const savedNotifications = localStorage.getItem('canvas39_notifications');
                if (savedNotifications) {
                    notifications = JSON.parse(savedNotifications);
                    console.log('üîî Loaded notifications:', notifications);
                }

                return { adminConfig, layoutConfig, customSlides, notifications };
            } catch (error) {
                console.error('‚ùå Error loading admin config:', error);
                return {};
            }
        }

        // Apply admin panel configuration to display
        function applyAdminConfig(config = {}) {
            console.log('üé® Applying admin configuration to display...');

            // Apply theme colors
            if (config.theme) {
                applyThemeConfig(config.theme);
            }

            // Apply font settings
            if (config.font || config.customFont) {
                applyFontConfig(config);
            }

            // Apply layout configuration
            if (layoutConfig) {
                applyLayoutConfig(layoutConfig);
            }

            // Apply slideshow configuration
            if (config.slideshow) {
                applySlideshowConfig(config.slideshow);
            }

            // Apply custom slides and notifications
            if (customSlides.length > 0) {
                integrateCustomSlides();
            }

            if (notifications.length > 0) {
                displayActiveNotifications();
            }

            // Apply section titles
            if (config.sectionTitles) {
                applySectionTitles(config.sectionTitles);
            }

            console.log('‚úÖ Admin configuration applied successfully');
        }

        // Apply section titles configuration
        function applySectionTitles(sectionTitles) {
            console.log('üìù Applying section titles configuration...');

            const titleMappings = {
                todayText: 'todayTextDisplay',
                outlookText: 'outlookTextDisplay', 
                airQualityText: 'airQualityTextDisplay',
                poolWaterText: 'poolWaterTextDisplay',
                indoorText: 'indoorTextDisplay',
                outdoorText: 'outdoorTextDisplay'
            };

            Object.entries(titleMappings).forEach(([configKey, elementId]) => {
                const element = document.getElementById(elementId);
                if (element && sectionTitles[configKey]) {
                    element.textContent = sectionTitles[configKey];
                    console.log(`üìù Updated ${configKey}: ${sectionTitles[configKey]}`);
                }
            });

            console.log('‚úÖ Section titles applied');
        }

        // Apply theme configuration
        function applyThemeConfig(theme) {
            console.log('üé® Applying theme configuration...');

            // Update header background
            if (theme.headerColor) {
                const header = document.querySelector('.bg-amber-900');
                if (header) {
                    header.style.backgroundColor = theme.headerColor;
                }
            }

            // Update main background
            if (theme.backgroundColor) {
                const mainBackground = document.querySelector('div[style*="background-color: #929079"]');
                if (mainBackground) {
                    mainBackground.style.backgroundColor = theme.backgroundColor;
                }
            }

            console.log('üé® Theme colors applied');
        }

        // Apply font configuration
        function applyFontConfig(config) {
            console.log('üî§ Applying font configuration...');

            let fontFamily = 'system-ui, sans-serif';

            if (config.font && config.font !== 'default') {
                if (config.font === 'custom' && config.customFont) {
                    // Apply custom font
                    try {
                        const fontFace = new FontFace(
                            'CustomDisplayFont',
                            `url(${config.customFont.data})`,
                            { display: 'swap' }
                        );
                        
                        fontFace.load().then(() => {
                            document.fonts.add(fontFace);
                            fontFamily = 'CustomDisplayFont, system-ui, sans-serif';
                            document.body.style.fontFamily = fontFamily;
                            console.log('‚úÖ Custom font applied');
                        }).catch(error => {
                            console.error('‚ùå Failed to load custom font:', error);
                        });
                    } catch (error) {
                        console.error('‚ùå Error applying custom font:', error);
                    }
                } else {
                    // Apply predefined font
                    const fontMap = {
                        'roman': '"Times New Roman", serif',
                        'kanit': 'Kanit, sans-serif',
                        'sarabun': 'Sarabun, sans-serif',
                        'inter': 'Inter, sans-serif',
                        'roboto': 'Roboto, sans-serif',
                        'noto-thai': '"Noto Sans Thai", sans-serif',
                        'prompt': 'Prompt, sans-serif',
                        'mitr': 'Mitr, sans-serif'
                    };

                    fontFamily = fontMap[config.font] || fontFamily;
                    
                    // Load Google Font if needed
                    if (['kanit', 'sarabun', 'inter', 'roboto', 'noto-thai', 'prompt', 'mitr'].includes(config.font)) {
                        const fontName = fontFamily.split(',')[0].replace(/['"]/g, '');
                        const link = document.createElement('link');
                        link.rel = 'stylesheet';
                        link.href = `https://fonts.googleapis.com/css2?family=${fontName.replace(' ', '+')}:wght@300;400;500;600;700&display=swap`;
                        document.head.appendChild(link);
                    }

                    document.body.style.fontFamily = fontFamily;
                    console.log(`üî§ Font applied: ${fontFamily}`);
                }
            }
        }

        // Apply layout configuration
        function applyLayoutConfig(layout) {
            console.log('üìê Applying layout configuration...');

            // Apply header settings
            if (layout.headerHeight) {
                const header = document.querySelector('.bg-amber-900');
                if (header) {
                    header.style.height = layout.headerHeight + 'px';
                }
            }

            if (layout.headerPaddingX || layout.headerPaddingY) {
                const header = document.querySelector('.bg-amber-900');
                if (header) {
                    if (layout.headerPaddingX) header.style.paddingLeft = header.style.paddingRight = layout.headerPaddingX + 'px';
                    if (layout.headerPaddingY) header.style.paddingTop = header.style.paddingBottom = layout.headerPaddingY + 'px';
                }
            }

            if (layout.logoSize) {
                const logo = document.querySelector('img[alt="Canvas 39 Logo"]');
                if (logo) {
                    logo.parentElement.style.width = layout.logoSize + 'px';
                    logo.parentElement.style.height = layout.logoSize + 'px';
                }
            }

            // Apply weather section settings
            if (layout.weatherHeight) {
                const weatherSection = document.querySelector('.weather-section-border');
                if (weatherSection) {
                    weatherSection.style.height = layout.weatherHeight + 'px';
                }
            }

            // Apply quality section settings
            if (layout.qualityHeight) {
                const qualitySection = document.querySelector('.swiper.quality-slideshow').parentElement;
                if (qualitySection) {
                    qualitySection.style.height = layout.qualityHeight + 'px';
                }
            }

            // Apply text sizes
            if (layout.weatherTextSize) {
                const tempElements = document.querySelectorAll('#lowTemp, #highTemp');
                tempElements.forEach(el => {
                    el.className = el.className.replace(/text-\w+/, layout.weatherTextSize);
                });
            }

            if (layout.qualityTextSize) {
                const aqiElements = document.querySelectorAll('#indoorAQI, #outdoorAQI');
                aqiElements.forEach(el => {
                    el.className = el.className.replace(/text-\w+/, layout.qualityTextSize);
                });
            }

            console.log('üìê Layout configuration applied');
        }

        // Apply slideshow configuration
        function applySlideshowConfig(slideshow) {
            console.log('üé¨ Applying slideshow configuration...');

            slideshowConfig = { ...slideshowConfig, ...slideshow };

            // Update global swiper instance if it exists
            if (window.swiper && slideshow.slideshowInterval) {
                const newDelay = parseInt(slideshow.slideshowInterval) * 1000;
                window.swiper.params.autoplay.delay = newDelay;
                
                if (window.swiper.autoplay) {
                    window.swiper.autoplay.stop();
                    window.swiper.autoplay.start();
                }
                
                console.log(`üé¨ Slideshow interval updated to ${slideshow.slideshowInterval}s`);
            }

            console.log('üé¨ Slideshow configuration applied');
        }

        // Listen for config updates from admin panel
        function listenForAdminUpdates() {
            console.log('üëÇ Listening for admin panel updates...');

            // Listen for localStorage changes (same tab)
            window.addEventListener('storage', function(e) {
                if (e.key === 'canvas39_admin_config') {
                    console.log('üîÑ Admin config updated, reloading...');
                    setTimeout(async () => {
                        const newConfig = await loadAdminConfig();
                        applyAdminConfig(newConfig.adminConfig);
                    }, 500);
                }

                if (e.key === 'canvas39_layout_config') {
                    console.log('üîÑ Layout config updated, reloading...');
                    setTimeout(() => {
                        const newLayoutConfig = JSON.parse(e.newValue || '{}');
                        applyLayoutConfig(newLayoutConfig);
                    }, 500);
                }
            });

            // Periodic check for updates (for cross-device sync)
            let lastConfigHash = '';
            setInterval(async () => {
                try {
                    const currentConfig = await loadAdminConfig();
                    const currentConfigHash = JSON.stringify(currentConfig.adminConfig || {});
                    
                    if (lastConfigHash && currentConfigHash !== lastConfigHash) {
                        console.log('üîÑ Config change detected from external source, applying updates...');
                        adminConfig = currentConfig.adminConfig || {};
                        layoutConfig = currentConfig.layoutConfig || {};
                        applyAdminConfig(adminConfig);
                    }
                    lastConfigHash = currentConfigHash;
                } catch (error) {
                    console.error('‚ùå Error checking config updates:', error);
                }
            }, 10000); // Check every 10 seconds
        }

        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ Canvas 39 GitHub Design initializing...');
            
            // Load and apply admin panel configuration first
            const adminConfigs = await loadAdminConfig();
            adminConfig = adminConfigs.adminConfig || {};
            layoutConfig = adminConfigs.layoutConfig || {};
            
            applyAdminConfig(adminConfig);
            
            // Start listening for admin updates
            listenForAdminUpdates();
            
            // Parse and apply configuration from URL parameters, JSONBin, or localStorage
            const config = await parseConfig();
            applyConfig(config);

            // Listen for real-time config updates from admin panel
            listenForConfigUpdates();

            // Check for config updates every 30 seconds (for fallback)
            setInterval(checkConfigUpdates, 30000);
            
            updateDateTime();
            
            try {
                await updateDisplay(config);
                console.log('‚úÖ Display update completed');
            } catch (error) {
                console.error('‚ùå Error in updateDisplay:', error);
            }
            
            // Initialize Swiper.js slideshow
            try {
                const swiperInstance = initializeSwiper();
                if (swiperInstance) {
                    console.log('‚úÖ Swiper slideshow ready with touch/swipe support for tablets');
                } else {
                    console.warn('‚ùå Failed to initialize Swiper slideshow');
                }
            } catch (error) {
                console.error('‚ùå Error initializing Swiper:', error);
            }
            
            // Fullscreen button
            document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å fullscreen
            const headerRight = document.createElement('div');
            headerRight.className = 'fixed top-0 right-0 w-20 h-20 z-50 cursor-pointer';
            headerRight.style.display = 'none';
            headerRight.title = 'Click to exit fullscreen';
            headerRight.addEventListener('click', function() {
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                }
            });
            document.body.appendChild(headerRight);
            
            // Listen for fullscreen changes
            document.addEventListener('fullscreenchange', function() {
                const btn = document.getElementById('fullscreenBtn');
                const icon = document.getElementById('fullscreenIcon');
                
                if (document.fullscreenElement) {
                    // ‡πÄ‡∏Ç‡πâ‡∏≤ fullscreen - ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å
                    btn.style.opacity = '0';
                    btn.style.pointerEvents = 'none';
                    headerRight.style.display = 'block';
                    icon.setAttribute('data-lucide', 'minimize');
                } else {
                    // ‡∏≠‡∏≠‡∏Å fullscreen - ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° ‡πÅ‡∏•‡∏∞‡∏ã‡πà‡∏≠‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å
                    btn.style.opacity = '1';
                    btn.style.pointerEvents = 'auto';
                    headerRight.style.display = 'none';
                    icon.setAttribute('data-lucide', 'maximize');
                }
                lucide.createIcons();
                feather.replace();
            });
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏î ESC ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å fullscreen
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && document.fullscreenElement) {
                    document.exitFullscreen();
                }
            });
            
            // Start clock
            setInterval(updateDateTime, 1000);
            
            // Auto-update weather data based on configured interval
            setInterval(async function() {
                console.log('üîÑ Auto-updating weather data...');
                // ‡πÉ‡∏ä‡πâ global config ‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ
                const savedConfig = JSON.parse(localStorage.getItem('canvas39_admin_config') || '{}');
                await updateDisplay(savedConfig);
            }, UPDATE_INTERVAL);

            // Custom Slides Integration Functions
            function integrateCustomSlides() {
                console.log('üé¨ Integrating custom slides into slideshow...');
                
                if (!customSlides || customSlides.length === 0) {
                    console.log('‚ÑπÔ∏è No custom slides to integrate');
                    return;
                }

                // Find the swiper wrapper to add custom slides
                const swiperWrapper = document.querySelector('.quality-slideshow .swiper-wrapper');
                if (!swiperWrapper) {
                    console.warn('‚ùå Swiper wrapper not found, cannot integrate custom slides');
                    return;
                }

                // Add custom slides to the slideshow
                customSlides.forEach((slide, index) => {
                    if (!slide.active) return; // Skip inactive slides

                    const customSlideElement = createCustomSlideElement(slide);
                    swiperWrapper.appendChild(customSlideElement);
                    
                    console.log(`‚úÖ Added custom slide: ${slide.title || 'Untitled'}`);
                });

                // Reinitialize Swiper to include new slides
                if (swiper) {
                    swiper.destroy(true, true);
                    setTimeout(() => {
                        initializeSwiper();
                        console.log('üîÑ Swiper reinitialized with custom slides');
                    }, 100);
                }
            }

            function createCustomSlideElement(slide) {
                const slideElement = document.createElement('div');
                slideElement.className = 'swiper-slide';
                
                let slideContent = '';
                
                switch (slide.type) {
                    case 'text':
                        slideContent = `
                            <div class="flex flex-col justify-center items-center h-full w-full p-8 text-center" 
                                 style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <h2 class="text-4xl font-bold text-white mb-6">${slide.title || 'Custom Slide'}</h2>
                                <div class="text-xl text-white opacity-90 leading-relaxed max-w-4xl whitespace-pre-wrap">
                                    ${slide.content || slide.textContent || 'No content provided'}
                                </div>
                                <div class="mt-6 text-sm text-white opacity-70">
                                    Duration: ${slide.duration || 10} seconds ‚Ä¢ Order: ${slide.order || 1}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'image':
                        slideContent = `
                            <div class="relative h-full w-full flex items-center justify-center" 
                                 style="background: linear-gradient(45deg, #000 0%, #333 100%);">
                                <img src="${slide.imageUrl}" alt="${slide.title || 'Custom Image'}" 
                                     class="max-w-full max-h-full object-contain"
                                     onerror="this.parentElement.innerHTML='<div class=\\'text-white text-center\\'>Image failed to load</div>'">
                                ${slide.title ? `
                                    <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-75 p-4">
                                        <h2 class="text-2xl font-bold text-white">${slide.title}</h2>
                                        <div class="text-sm text-white opacity-70 mt-1">
                                            Duration: ${slide.duration || 10} seconds ‚Ä¢ Order: ${slide.order || 1}
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                        break;
                        
                    case 'custom':
                    case 'html':
                        slideContent = `
                            <div class="h-full w-full relative">
                                ${slide.htmlContent || slide.content || '<div class="flex items-center justify-center h-full"><p class="text-xl">Custom HTML Content</p></div>'}
                                ${slide.title ? `
                                    <div class="absolute top-4 left-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded text-sm">
                                        ${slide.title} ‚Ä¢ ${slide.duration || 10}s
                                    </div>
                                ` : ''}
                            </div>
                        `;
                        break;
                        
                    default:
                        slideContent = `
                            <div class="flex flex-col justify-center items-center h-full w-full p-8 text-center bg-gray-500">
                                <h2 class="text-3xl font-bold text-white mb-4">Unknown Slide Type</h2>
                                <p class="text-white opacity-75">Slide type "${slide.type}" is not supported</p>
                            </div>
                        `;
                }
                
                slideElement.innerHTML = slideContent;
                return slideElement;
            }

            // Notification Display Functions
            function displayActiveNotifications() {
                console.log('üîî Displaying active notifications...');
                
                const activeNotifications = notifications.filter(notification => {
                    if (!notification.active) return false;
                    
                    const now = Date.now();
                    const startTime = notification.scheduleDate ? new Date(notification.scheduleDate).getTime() : 0;
                    const endTime = notification.endDate ? new Date(notification.endDate).getTime() : Infinity;
                    
                    return now >= startTime && now <= endTime;
                });

                if (activeNotifications.length === 0) {
                    console.log('‚ÑπÔ∏è No active notifications to display');
                    return;
                }

                // Display notifications as overlay
                activeNotifications.forEach((notification, index) => {
                    setTimeout(() => {
                        showNotificationOverlay(notification);
                    }, index * 2000); // Stagger notifications by 2 seconds
                });
            }

            function showNotificationOverlay(notification) {
                // Create notification overlay
                const overlay = document.createElement('div');
                overlay.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50';
                overlay.style.animation = 'fadeIn 0.5s ease-in-out';

                const notificationBox = document.createElement('div');
                notificationBox.className = 'bg-white rounded-lg shadow-2xl max-w-md w-full mx-4 p-6 text-center transform transition-all duration-500';
                
                // Notification type styling
                let bgColor = 'bg-blue-500';
                let iconSvg = '<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
                
                switch (notification.type) {
                    case 'warning':
                        bgColor = 'bg-yellow-500';
                        iconSvg = '<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>';
                        break;
                    case 'error':
                        bgColor = 'bg-red-500';
                        iconSvg = '<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
                        break;
                    case 'success':
                        bgColor = 'bg-green-500';
                        iconSvg = '<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
                        break;
                }

                notificationBox.innerHTML = `
                    <div class="${bgColor} w-16 h-16 rounded-full flex items-center justify-center text-white mx-auto mb-4">
                        ${iconSvg}
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">${notification.title}</h3>
                    <p class="text-gray-600 mb-4">${notification.message}</p>
                    <div class="text-sm text-gray-500 mb-4">
                        Priority: ${notification.priority || 'normal'} ‚Ä¢ 
                        Type: ${notification.type || 'info'}
                    </div>
                    <button onclick="this.closest('.fixed').remove()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                        OK
                    </button>
                `;

                overlay.appendChild(notificationBox);
                document.body.appendChild(overlay);

                // Auto-remove notification after specified duration
                const duration = (notification.duration || 10) * 1000;
                setTimeout(() => {
                    if (overlay.parentNode) {
                        overlay.style.animation = 'fadeOut 0.5s ease-in-out';
                        setTimeout(() => {
                            overlay.remove();
                        }, 500);
                    }
                }, duration);

                console.log(`‚úÖ Displayed notification: ${notification.title}`);
            }

            // Add CSS animations for notifications
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeIn {
                    from { opacity: 0; transform: scale(0.9); }
                    to { opacity: 1; transform: scale(1); }
                }
                @keyframes fadeOut {
                    from { opacity: 1; transform: scale(1); }
                    to { opacity: 0; transform: scale(0.9); }
                }
            `;
            document.head.appendChild(style);
            
            console.log('‚úÖ GitHub Design version loaded successfully');
            
            // Initialize Feather icons
            feather.replace();
        });
    </script>
</body>
</html>
